<mat-card class="cardWithShadow theme-card">
  <mat-card-header>
    <mat-card-title class="m-b-0">Clientes</mat-card-title>
  </mat-card-header>
  <mat-card-content class="b-t-1">
    <button (click)="openModalRegistrar()" mat-flat-button color="primary" class="w-10">+Nuevo cliente</button>

    <div class="row">
      <div class="col-xl-12">
        <div class="table-responsive">
          <table mat-table [dataSource]="clientes" class="mat-elevation-z8">

            <!-- Número Column -->
            <ng-container matColumnDef="idcliente">
              <th mat-header-cell *matHeaderCellDef>N°</th>
              <td mat-cell *matCellDef="let cliente; let i = index">{{ i + 1 }}</td>
            </ng-container>

            <!-- Nombre Apellidos y Nombres -->
            <ng-container matColumnDef="apellidos">
              <th mat-header-cell *matHeaderCellDef>Apellidos y Nombres</th>
              <td mat-cell *matCellDef="let cliente">{{ cliente.apellidos }} {{ cliente.nombres }}</td>
            </ng-container>
            <!-- Dni -->
            <ng-container matColumnDef="dni">
              <th mat-header-cell *matHeaderCellDef>Dni</th>
              <td mat-cell *matCellDef="let cliente">{{ cliente.dni }}</td>
            </ng-container>
            <!-- Rol -->
            <ng-container matColumnDef="celular">
              <th mat-header-cell *matHeaderCellDef>Celular</th>
              <td mat-cell *matCellDef="let cliente">{{ cliente.celular }}</td>
            </ng-container>
            <!-- Rol -->
            <ng-container matColumnDef="preferencias">
              <th mat-header-cell *matHeaderCellDef>Preferencia</th>
              <td mat-cell *matCellDef="let cliente">{{ cliente.preferencias }}</td>
            </ng-container>
            <!-- Opciones Column -->
            <ng-container matColumnDef="options">
              <th mat-header-cell *matHeaderCellDef>Opción</th>
              <td mat-cell *matCellDef="let user">
                <button mat-flat-button color="accent">Editar</button>
                <button mat-flat-button color="warn">Eliminar</button>
              </td>
            </ng-container>

            <tr mat-header-row
              *matHeaderRowDef="['idcliente', 'apellidos', 'dni', 'celular', 'preferencias', 'options']">
            </tr>
            <tr mat-row
              *matRowDef="let row; columns: ['idcliente', 'apellidos', 'dni', 'celular', 'preferencias', 'options']">
            </tr>
          </table>
        </div>
      </div>
    </div>
  </mat-card-content>
</mat-card>
<!-- Modal Registrar -->
<div *ngIf="isModalOpen" class="modal-container">
  <div class="modal-content">
    <div class="modal-header" style="display: flex; align-items: center; justify-content: space-between;">
      <h2 style="margin: 0; font-size: 1.5rem; color: #1631cf;">Registrar Cliente</h2>
      <button mat-icon-button (click)="closeModal()" aria-label="Cerrar">
        <mat-icon
          style="background: rgb(255, 81, 0); border-radius: 50%; padding: 8px; display: flex; align-items: center; justify-content: center;">
          <span style="color: #ffffff; font-size: 1.5rem;">×</span>
        </mat-icon>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="clientForm" (ngSubmit)="onSubmit()" style="padding: 16px;">
        <div style="display: flex; align-items: center; margin-bottom: 16px;">
          <mat-form-field appearance="fill">
            <mat-label>Apellidos</mat-label>
            <input matInput type="text" formControlName="apellidos" required>
            <mat-error *ngIf="clientForm.get('apellidos')?.invalid && clientForm.get('apellidos')?.touched">
              Apellidos es requerido.
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Nombres</mat-label>
            <input matInput type="text" formControlName="nombres" required>
            <mat-error *ngIf="clientForm.get('nombres')?.invalid && clientForm.get('nombres')?.touched">
              Nombres es requerido.
            </mat-error>
          </mat-form-field>
        </div>
        <div style="display: flex; align-items: center; margin-bottom: 16px;">
          <mat-form-field appearance="fill">
            <mat-label>Dni</mat-label>
            <input matInput formControlName="dni" maxlength="8" minlength="8" required
              (keypress)="onlyNumber($event)" />
            <mat-error
              *ngIf="clientForm.get('dni')?.hasError('minlength') || clientForm.get('dni')?.hasError('maxlength')">
              El DNI debe tener 8 dígitos.
            </mat-error>
            <mat-error
              *ngIf="clientForm.get('dni')?.invalid && clientForm.get('dni')?.touched && !clientForm.get('dni')?.hasError('minlength') && !clientForm.get('dni')?.hasError('maxlength')">
              Este campo es requerido.
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Celular</mat-label>
            <input matInput type="text" formControlName="celular" required maxlength="9"
              (keypress)="onlyNumber($event)" />
            <mat-error *ngIf="clientForm.get('celular')?.hasError('required') && clientForm.get('celular')?.touched">
              Digite su celular
            </mat-error>
            <mat-error
              *ngIf="(clientForm.get('celular')?.hasError('minlength') || clientForm.get('celular')?.hasError('maxlength')) && clientForm.get('celular')?.touched">
              El celular debe tener 9 dígitos.
            </mat-error>
          </mat-form-field>
        </div>
        <mat-form-field appearance="fill" style="width: 100%;">
          <mat-label>Preferencias</mat-label>
          <input matInput type="text" formControlName="preferencias">
        </mat-form-field>
        <div class="modal-actions" style="display: flex; justify-content: center; margin-top: 16px;">
          <button mat-raised-button class="green-button" type="submit" [disabled]="!clientForm.valid">
            Guardar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>